<pre>
A cookie's domain specifies which websites should be able to read it. Left blank, browsers are supposed to only send the cookie to sites that exactly match the sending domain. For example, if a cookie was set by _lovely.dream.com_, it should only be readable by that domain, and not by _nightmare.com_ or even _strange.dream.com_. If you want to allow sub-domain access for a cookie, you can specify it by adding a dot in front of the cookie's domain, like so: _.dream.com_. But cookie domains should always use at least two levels.
</pre>
<p>Cookie domains can be set either programmatically or via configuration. This rule raises an issue when any cookie domain is set with a single level, as in <em>.com</em>.</p>
<h2>Ask Yourself Whether</h2>
<ul>
<li>the &lt;code&gt;domain&lt;/code&gt; attribute has only one level as domain naming.</li>
</ul>
<p>You are at risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
<li>You should check the &lt;code&gt;domain&lt;/code&gt; attribute has been set and its value has more than one level of domain nanimg, like: <em>sonarsource.com</em></li>
</ul>
<h2>Sensitive Code Examples</h2>
<p>For python3:</p>
<pre>
import http.cookies

setCookie = http.cookies.SimpleCookie()
setCookie['restricted_cookie'] = 'cookie_value'
setCookie['restricted_cookie']['domain'] = '.com'   # Sensitive
setCookie['restricted_cookie']['path'] = '/'
</pre>
<p>For flask:</p>
<pre>
from flask import app, make_response, render_template

@app.route('/')
def index():
    http_response = make_response(render_template())
    http_response.set_cookie(
        "restricted_cookie",
        domain='.com',          # Sensitive
        path='/'
    )

    return http_response
</pre>
<h2>Compliant Solution</h2>
<p>For python3:</p>
<pre>
import http.cookies

setCookie = http.cookies.SimpleCookie()
setCookie['restricted_cookie'] = 'cookie_value'
setCookie['restricted_cookie']['domain'] = '.sonarsource.com'   # Compliant
setCookie['restricted_cookie']['path'] = '/'
</pre>
<p>For flask:</p>
<pre>
from flask import app, make_response, render_template


@app.route('/')
def index():
    http_response = make_response(render_template())
    http_response.set_cookie(
        "restricted_cookie",
        domain='sonarsource.com',  # Compliant
        path='/'
    )

    return http_response
</pre>
<h2>See</h2>
<ul>
<li><a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure</li>
</ul>
