<p>A call to the &lt;code&gt;fopen()&lt;/code&gt;/&lt;code&gt;open()&lt;/code&gt; function must be matched with a call to &lt;code&gt;fclose()&lt;/code&gt;/&lt;code&gt;close&lt;/code&gt;. Otherwise, you run the risk of using up all the OSâ€™s file handles, which could lock up not just your program but potentially everything on the box.</p>
<h2>Noncompliant Code Example</h2>
<pre>
int fun() {
  FILE *f = fopen("file", "r");
  if (f == NULL) {
    return -1;
  }
  // ...
  return 0; // Noncompliant, file f has not been closed
}
</pre>
<h2>Compliant Solution</h2>
<pre>
int fun() {
  FILE *f = fopen("file", "r");
  if (f == NULL) {
    return -1;
  }
  // ...
  fclose(f);
  return 0;
}
</pre>
<h2>See</h2>
<ul>
<li><a href="http://cwe.mitre.org/data/definitions/459.html">MITRE, CWE-459</a> - Incomplete Cleanup</li>
<li><a href="http://cwe.mitre.org/data/definitions/772.html">MITRE, CWE-772</a> - Missing Release of Resource after Effective Lifetime</li>
<li><a href="https://www.securecoding.cert.org/confluence/x/9gFqAQ">CERT, FIO04-J.</a> - Release resources when they are no longer needed</li>
<li><a href="https://www.securecoding.cert.org/confluence/x/GAGQBw">CERT, FIO42-C.</a> - Close files when they are no longer needed</li>
<li><a href="https://docs.oracle.com/javase/tutorial/essential/exceptions/tryResourceClose.html">Try With Resources</a></li>
</ul>
