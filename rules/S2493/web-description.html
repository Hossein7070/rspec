<p>Just because you <em>can</em> do something, that doesn’t mean you <em>should</em>, and the use of full-fledged Java in a JSP or JSF falls into that category.</p>
<p>Beside the fact that such code isn’t resuable, testable, maintainable or OO-inheritable, using Java in such client-side pages can leave you incredibly vulnerable from a number of perspectives including security and resource management.</p>
<p>Instead, any heavy-duty logic should happen server-side in a full-fledged Java class. For lighter-weight functions, taglibs should be used.</p>
<p>This rule flags all uses of JSP declarations (&lt;code&gt;&lt;%! …​ %&gt;&lt;/code&gt; and &lt;code&gt;&lt;jsp:declaration&gt;…​&lt;/jsp:declaration&gt;&lt;/code&gt;) and scriptlets (&lt;code&gt;&lt;% …​ %&gt;&lt;/code&gt;).</p>
<h2>Noncompliant Code Example</h2>
<pre>
&lt;%!  // Noncompliant
  private Connection conn = null;

  public void init() {
    try {
      Class.forName("org.hsqldb.jdbcDriver" );
      conn = DriverManager.getConnection("jdbc:hsqldb:mem:SQL", "sa", "");
    } catch (SQLException e) {
      getServletContext().log("Db error: " + e);
    } catch (Exception e) {
    getServletContext().log("System error: " + e);
    }
  }
%&gt;
&lt;%    // Noncompliant
Statement stmt = conn.createStatement();
ResultSet rs = null;
String query = StringEscapeUtils.escapeHtml4(query).replaceAll("'", "&amp;#39");

try {
  String sql = "SELECT PRODUCT, DESC, TYPE, PRICE " +
                     "FROM PRODUCTS" +
                     "WHERE PRODUCT LIKE '%" + query + "%'";
  rs = stmt.executeQuery(sql);

  String output = "";
  int count = 0;
  while (rs.next()) {
    count++;
    output = output.concat("&lt;TR&gt;&lt;TD&gt;" + rs.getString("PRODUCT") +
                                  "&lt;/TD&gt;&lt;TD&gt;" + rs.getString("DESC") +
                                  "&lt;/TD&gt;&lt;TD&gt;" + rs.getString("TYPE") +
                                  "&lt;/TD&gt;&lt;TD&gt;" + rs.getString("PRICE") + "&lt;/TD&gt;&lt;/TR&gt;\n");
  }
  if(count &gt; 0){
%&gt;
&lt;TABLE border="1"&gt;
&lt;TR&gt;&lt;TD&gt;Product&lt;/TD&gt;&lt;TD&gt;Description&lt;/TD&gt;&lt;TD&gt;Type&lt;/TD&gt;&lt;TD&gt;Price&lt;/TD&gt;&lt;/TR&gt;
&lt;%= output %&gt;
&lt;/TABLE&gt;
&lt;%  // Noncompliant
  }
} catch (Exception e) {
  // ...
</pre>
<h2>Compliant Solution</h2>
<pre>
&lt;%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %&gt;

&lt;table&gt;
    &lt;c:forEach items="${products}" var="product"&gt;
        &lt;tr&gt;
            &lt;td&gt;${product.name}&lt;/td&gt;
            &lt;td&gt;${product.description}&lt;/td&gt;
            &lt;td&gt;${product.type}&lt;/td&gt;
            &lt;td&gt;${product.price}&lt;/td&gt;
        &lt;/tr&gt;
    &lt;/c:forEach&gt;
&lt;/table&gt;
</pre>
