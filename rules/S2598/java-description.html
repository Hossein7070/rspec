<p>These minimum restrictions should be applied when handling file uploads:
- the file upload folder to restrict untrusted files to a specific folder.
- the file extension of the uploaded file to prevent remote code execution.</p>
<p>Also the size of the uploaded file should be limited to prevent denial of service attacks. This requirement is covered by the rule S5693.</p>
<h2>Noncompliant Code Example</h2>
<pre>
public void doPost(HttpServletRequest request, HttpServletResponse response) throws IOException {

  if (ServletFileUpload.isMultipartContent(request)) {

    FileItemFactory factory = new DiskFileItemFactory();
    ServletFileUpload upload = new ServletFileUpload(factory);  // Noncompliant
    // ...
</pre>
<h2>See</h2>
<ul>
<li><a href="http://cwe.mitre.org/data/definitions/434">CWE-434</a> - Unrestricted Upload of File with Dangerous Type</li>
<li><a href="https://cwe.mitre.org/data/definitions/400.html">CWE-400</a> - Uncontrolled Resource Consumption</li>
<li><a href="https://www.owasp.org/index.php/Top_10_2010-A4-Insecure_Direct_Object_References">OWASP Top 10 2017 Category A4</a> - Insecure Direct Object References</li>
<li><a href="https://www.owasp.org/index.php/Unrestricted_File_Upload">OWASP Unrestricted File Upload</a> - Unrestricted File Upload</li>
<li><a href="https://wiki.sei.cmu.edu/confluence/display/java/IDS56-J.+Prevent+arbitrary+file+upload">CERT, IDS56-J.</a> - Prevent arbitrary file upload</li>
<li><a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components</li>
</ul>
