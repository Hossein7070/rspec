<p>According to the EJB specification:</p>
<p>{quote}
An enterprise bean must not attempt to listen on a socket, accept connections on a socket, or use a socket for multicast.
…​</p>
<ul>
<li>The enterprise bean must not attempt to set the socket factory used by ServerSocket, Socket, or the stream handler factory used by URL.</li>
</ul>
<p>These networking functions are reserved for the EJB container. Allowing the enterprise bean to use these functions could compromise security and decrease the container’s ability to properly manage the runtime environment.
{quote}</p>
<p>Since EJB’s may be passivated (temporarily serialized at the discretion of the container), using sockets in an EJB could cause resource leaks. Instead, you should work at a higher level and let the container handle such resources.</p>
<p>This rule raises an issue each time a socket is created or or retrieved from another class in a servlet class or EJB.</p>
<h2>Noncompliant Code Example</h2>
<pre>
public void doGet(HttpServletRequest request, HttpServletResponse response) throws ServletException, IOException {
  // ...

  Socket sock = null;
  try {
    sock = new Socket(host, 3000);  // Noncompliant
    // ...
  } catch (Exception e) {
    // ...
  }
}
</pre>
<h2>See</h2>
<ul>
<li><a href="http://cwe.mitre.org/data/definitions/246.html">MITRE, CWE-246</a> - J2EE Bad Practices: Direct Use of Sockets</li>
<li><a href="http://cwe.mitre.org/data/definitions/577.html">MITRE, CWE-577</a> - EJB Bad Practices: Use of Sockets</li>
</ul>
