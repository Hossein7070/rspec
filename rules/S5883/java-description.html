<p>Applications that allow execution of operating system commands from user-controlled data should control the arguments passed to the command to execute, otherwise an attacker can inject additional arbitrary arguments which can change the command behavior.</p>
<p>Command arguments constructed from user-controlled data should be sanitized in order to escape argument delimiters (eg: ', space, - ) preventing argument injection attacks.</p>
<h2>Noncompliant Code Example</h2>
<pre>
import java.io.IOException;
import javax.servlet.http.HttpServletRequest;

public void runUnsafe(HttpServletRequest request) throws IOException {
  String folder = request.getParameter("folder");

  String cmd = "mkdir " + folder;

  Runtime.getRuntime().exec(cmd); // Noncompliant
}
</pre>
<h2>Compliant Solution</h2>
<pre>
import java.io.IOException;
import javax.servlet.http.HttpServletRequest;

public void runSafe(HttpServletRequest request) throws IOException {
  String folderarg1 = request.getParameter("folder");

  String cmd[] =  new String[] { "mkdir", folderarg1 };

  Runtime.getRuntime().exec(cmd); // Compliant
}
</pre>
<h2>See</h2>
<ul>
<li>OWASP OS Command Injection Defense <a href="https://cheatsheetseries.owasp.org/cheatsheets/OS_Command_Injection_Defense_Cheat_Sheet.html">Cheat Sheet</a></li>
<li><a href="https://www.owasp.org/index.php/Top_10-2017_A1-Injection">OWASP Top 10 2017 Category A1</a> - Injection</li>
<li><a href="http://cwe.mitre.org/data/definitions/88">MITRE, CWE-88</a> - Argument Injection or Modification</li>
<li><a href="https://www.sans.org/top25-software-errors/#cat1">SANS Top 25</a> - Insecure Interaction Between Components</li>
</ul>
