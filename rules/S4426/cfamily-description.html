<p>Most of cryptographic systems require a sufficient key size to be robust against brute-force attacks.
<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar2.pdf">NIST recommendations</a> will be checked for these use-cases:</p>
<p><strong>Digital Signature Generation</strong> and <strong>Verification:</strong></p>
<ul>
<li>p ≥ 2048 AND q ≥ 224 for DSA (&lt;code&gt;p&lt;/code&gt; is key length and &lt;code&gt;q&lt;/code&gt; the modulus length)</li>
<li>n ≥ 2048 for  RSA (&lt;code&gt;n&lt;/code&gt; is the key length)</li>
</ul>
<p><strong>Key Agreement</strong>:</p>
<ul>
<li>p ≥ 2048 AND q ≥ 224 for DH and MQV</li>
<li>n ≥ 224 for ECDH and ECMQV  (Examples: &lt;code&gt;secp192r1&lt;/code&gt; is a non-compliant curve (&lt;code&gt;n&lt;/code&gt; &lt; 224) but &lt;code&gt;secp224k1&lt;/code&gt; is compliant (&lt;code&gt;n&lt;/code&gt; &gt;= 224))</li>
</ul>
<p><strong>Encryption and Decryption</strong>:</p>
<ul>
<li>AES-128, 192, 256</li>
</ul>
<p>This rule will not raise issues for ciphers that are considered weak (no matter the key size) like &lt;code&gt;DES&lt;/code&gt;, &lt;code&gt;Blowfish&lt;/code&gt;.</p>
<h2>Noncompliant Code Example</h2>
<pre>
/* RSA keys set the key length during key generation rather than parameter generation! */
if (type == EVP_PKEY_RSA) {
  if (!EVP_PKEY_CTX_set_rsa_keygen_bits(kctx, 1024)) { // Noncompliant
    goto err;
  }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
/* RSA keys set the key length during key generation rather than parameter generation! */
if (type == EVP_PKEY_RSA) {
  if (!EVP_PKEY_CTX_set_rsa_keygen_bits(kctx, 2048)) { // Compliant
    goto err;
  }
}
</pre>
<h2>See</h2>
<ul>
<li><a href="https://www.owasp.org/index.php/Top_10-2017_A3-Sensitive_Data_Exposure">OWASP Top 10 2017 Category A3</a> - Sensitive Data Exposure</li>
<li><a href="https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration">OWASP Top 10 2017 Category A9</a> - Security Misconfiguration</li>
<li><a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-131Ar1.pdf">NIST 800-131A</a> - Recommendation for Transitioning the Use of Cryptographic Algorithms and Key Lengths</li>
<li><a href="http://cwe.mitre.org/data/definitions/326.html">MITRE, CWE-326</a> - Inadequate Encryption Strength</li>
</ul>
