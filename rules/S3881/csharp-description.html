<p>The &lt;code&gt;IDisposable&lt;/code&gt; interface is a mechanism to release unmanaged resources, if not implemented correctly this could result in resource leaks or more severe bugs.</p>
<p>This rule raises an issue when the recommended dispose pattern, as defined by Microsoft, is not adhered to. See the <strong>Compliant Solution</strong> section for examples.</p>
<p>Satisfying the rule’s conditions will enable potential derived classes to correctly dispose the members of your class:</p>
<ul>
<li>&lt;code&gt;sealed&lt;/code&gt; classes are not checked.</li>
<li>If a base class implements &lt;code&gt;IDisposable&lt;/code&gt; your class should not have &lt;code&gt;IDisposable&lt;/code&gt; in the list of its interfaces. In such cases it is recommended to override the base class’s &lt;code&gt;protected virtual void Dispose(bool)&lt;/code&gt; method or its equivalent.</li>
<li>The class should not implement &lt;code&gt;IDisposable&lt;/code&gt; explicitly, e.g. the &lt;code&gt;Dispose()&lt;/code&gt; method should be public.</li>
<li>The class should contain &lt;code&gt;protected virtual void Dispose(bool)&lt;/code&gt; method. This method allows the derived classes to correctly dispose the resources of this class.</li>
<li>The content of the &lt;code&gt;Dispose()&lt;/code&gt; method should be invocation of &lt;code&gt;Dispose(true)&lt;/code&gt; followed by &lt;code&gt;GC.SuppressFinalize(this)&lt;/code&gt;</li>
<li>If the class has a finalizer, i.e. a destructor, the only code in its body should be a single invocation of &lt;code&gt;Dispose(false)&lt;/code&gt;.</li>
<li>If the class inherits from a class that implements &lt;code&gt;IDisposable&lt;/code&gt; it must call the &lt;code&gt;Dispose&lt;/code&gt;, or &lt;code&gt;Dispose(bool)&lt;/code&gt; method of the base class from within its own implementation of &lt;code&gt;Dispose&lt;/code&gt; or &lt;code&gt;Dispose(bool)&lt;/code&gt;, respectively. This ensures that all resources from the base class are properly released.</li>
</ul>
<h2>Noncompliant Code Example</h2>
<pre>
public class Foo1 : IDisposable // Noncompliant - provide protected overridable implementation of Dispose(bool) on Foo or mark the type as sealed.
{
    public void Dispose() // Noncompliant - should contain only a call to Dispose(true) and then GC.SuppressFinalize(this)
    {
        // Cleanup
    }
}

public class Foo2 : IDisposable
{
    void IDisposable.Dispose() // Noncompliant - Dispose() should be public
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    public virtual void Dispose() // Noncompliant - Dispose() should be sealed
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }
}

public class Foo3 : IDisposable
{
    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        // Cleanup
    }

    ~Foo3() // Noncompliant - Modify Foo.~Foo() so that it calls Dispose(false) and then returns.
    {
        // Cleanup
    }
}{code}
</pre>
<h2>Compliant Solution</h2>
<pre>
// Sealed class
public sealed class Foo1 : IDisposable
{
    public void Dispose()
    {
        // Cleanup
    }
}

// Simple implementation
public class Foo2 : IDisposable
{
    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        // Cleanup
    }
}

// Implementation with a finalizer
public class Foo3 : IDisposable
{
    public void Dispose()
    {
        Dispose(true);
        GC.SuppressFinalize(this);
    }

    protected virtual void Dispose(bool disposing)
    {
        // Cleanup
    }

    ~Foo3()
    {
        Dispose(false);
    }
}

// Base disposable class
public class Foo4 : DisposableBase
{
    protected override void Dispose(bool disposing)
    {
        // Cleanup
        // Do not forget to call base
        base.Dispose(disposing);
    }
}
</pre>
<h2>See</h2>
<p>Refer to</p>
<ul>
<li><a href="https://msdn.microsoft.com/en-us/library/498928w2.aspx">MSDN</a> for complete documentation on the dispose pattern.</li>
<li><a href="http://blog.stephencleary.com/2009/08/how-to-implement-idisposable-and.html">Stephen Cleary</a> for excellent Q&amp;A about IDisposable</li>
<li><a href="http://pragmateek.com/c-scope-your-global-state-changes-with-idisposable-and-the-using-statement/">Pragma Geek</a> for additional usages of IDisposable, beyond releasing resources.</li>
<li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.idisposable?view=netframework-4.7">IDisposable documentation</a></li>
</ul>
