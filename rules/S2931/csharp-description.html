<p>An &lt;code&gt;IDisposable&lt;/code&gt; object should be disposed (there are some rare exceptions where not disposing is fine, most notably &lt;code&gt;Task&lt;/code&gt;). If a class has an &lt;code&gt;IDisposable&lt;/code&gt; field, there can be two situations:
- The class observes a field that it under the responsibility of another class.
- The class owns the field, and is therefore responsible for calling &lt;code&gt;Dispose&lt;/code&gt; on it.</p>
<p>In the second case, the safest way for the class to ensure &lt;code&gt;Dispose&lt;/code&gt; is called is to call it in its own &lt;code&gt;Dispose&lt;/code&gt; function, and therefore to be itself &lt;code&gt;IDisposable&lt;/code&gt;. A class is considered to own an &lt;code&gt;IDisposable&lt;/code&gt; field resource if it created the object referenced by the field.</p>
<h2>Noncompliant Code Example</h2>
<pre>
public class ResourceHolder   // Noncompliant; doesn't implement IDisposable
{
  private FileStream fs;  // This member is never Disposed
  public void OpenResource(string path)
  {
    this.fs = new FileStream(path, FileMode.Open); // I create the FileStream, I'm owning it
  }
  public void CloseResource()
  {
    this.fs.Close();
  }
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public class ResourceHolder : IDisposable
{
&nbsp;&nbsp;private FileStream fs;
&nbsp;&nbsp;public void OpenResource(string path)
&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;this.fs = new FileStream(path, FileMode.Open); // I create the FileStream, I'm owning it
&nbsp;&nbsp;}
&nbsp;&nbsp;public void CloseResource()
&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;this.fs.Close();
&nbsp;&nbsp;}

&nbsp;&nbsp;public void Dispose()
&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;this.fs.Dispose();
&nbsp;&nbsp;}
}
</pre>
<h2>See</h2>
<ul>
<li><a href="http://cwe.mitre.org/data/definitions/459.html">MITRE, CWE-459</a> - Incomplete Cleanup</li>
</ul>
