<p>Hidden files are created automatically by many tools to save user-preferences, well-known examples are &lt;code&gt;.profile&lt;/code&gt;, &lt;code&gt;.bashrc&lt;/code&gt;, &lt;code&gt;.bash_history&lt;/code&gt; or .&lt;code&gt;git&lt;/code&gt;. To simplify the view these files are not displayed by default using operating system commands like &lt;code&gt;ls&lt;/code&gt;.</p>
<p>Outside of the user environment, hidden files are sensitive because they are used to store privacy-related information or even hard-coded secrets.</p>
<h2>Ask Yourself Whether</h2>
<ul>
<li>Hidden files may have been inadvertently uploaded to the static serverâ€™s public directory and it accepts requests to hidden files.</li>
<li>There is no business use cases linked to serve files in &lt;code&gt;.name&lt;/code&gt; format but the server is not configured to reject requests to this type of files.</li>
</ul>
<p>There is a risk if you answered yes to any of those questions.</p>
<h2>Recommended Secure Coding Practices</h2>
<ul>
<li>Disable the serving of hidden files.</li>
</ul>
<h2>Sensitive Code Example</h2>
<p><a href="https://www.npmjs.com/package/serve-static">Express.js serve-static</a> middleware:</p>
<pre>
let serveStatic = require("serve-static");
let app = express();
let serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'allow'});   // Sensitive
app.use(serveStaticMiddleware);
</pre>
<h2>Compliant Solution</h2>
<p><a href="https://www.npmjs.com/package/serve-static">Express.js serve-static</a> middleware:</p>
<pre>
let serveStatic = require("serve-static");
let app = express();
let serveStaticMiddleware = serveStatic('public', { 'index': false, 'dotfiles': 'ignore'});   // Compliant: ignore or deny are recommended values
let serveStaticDefault = serveStatic('public', { 'index': false});   // Compliant: by default dot files inside directories not starting with dot are not served
app.use(serveStaticMiddleware);
</pre>
<h2>See</h2>
<ul>
<li><a href="https://github.com/mtojek/go-url-fuzzer">github.com/mtojek/go-url-fuzzer</a> - Discover hidden files and directories on a web server.</li>
<li><a href="https://www.owasp.org/index.php/Top_10-2017_A6-Security_Misconfiguration">OWASP Web Top 10 2017 Category A6</a> - Security Misconfiguration.</li>
<li><a href="https://cwe.mitre.org/data/definitions/538.html">CWE-538</a> - File and Directory Information Exposure</li>
</ul>
