<p>By default Apex code executes without checking permissions. Hence the code will not enforce field level security, sharing rules and user permissions during execution of Apex code in Triggers, Classes and Controllers. This creates the risk that unauthorized users may get access to sensitive data records or fields.</p>
<p>To prevent this, developers should use &lt;code&gt;with sharing&lt;/code&gt; keyword when declaring their classes if the class has SOQL or SOSL queries or DML Statements. This will ensure that current user’s permissions, field level security and sharing rules are enforced during code execution. Thus users will only see or modify records and fields which they have access to.</p>
<p>Use &lt;code&gt;without sharing&lt;/code&gt; when a specific class should have full access to records without taking into account current user’s permissions. This should be used very carefully.</p>
<p>Use &lt;code&gt;inherited sharing&lt;/code&gt; when the code should inherit the level of access from the calling class. This is more secure than not specifying a sharing level as the default will be equivalent to "with sharing".</p>
<p>This rule raises an issue when a class containing DML, SOSL or SOQL queries has no sharing level specified (&lt;code&gt;with sharing&lt;/code&gt;, &lt;code&gt;without sharing&lt;/code&gt;, &lt;code&gt;inherited sharing&lt;/code&gt;).</p>
<h2>Noncompliant Code Example</h2>
<pre>
public class MyClass { // Noncompliant, no sharing specified
  List&lt;Case&gt; lstCases = new List&lt;Case&gt;();
  for(Case c:[SELECT Id FROM Case WHERE Status = 'In Progress']){ // SOQL query
      // ...
  }
}

public class MyClass { // Noncompliant
  List&lt;List&lt;SObject&gt;&gt; sList = [FIND 'TEST' IN ALL FIELDS
                                      RETURNING Case(Name), Contact(FirstName,LastName)]; // SOSL query

}

public class MyClass { // Noncompliant
  List&lt;Case&gt; lstCases = new List&lt;Case&gt;();
  for(Case c:[SELECT Id, Status FROM Case WHERE Status = 'In Progress']){
      c.Status = 'Closed';
      lstCasesToBeUpdated.add(c);
  }
  Update lstCasesToBeUpdated;  // DML query
}
</pre>
<h2>Compliant Solution</h2>
<pre>
public with sharing class MyClass {
  List&lt;Case&gt; lstCases = new List&lt;Case&gt;();
  for(Case c:[SELECT Id FROM Case WHERE Status = 'In Progress']){
      // ...
  }
}

public without sharing class MyClass {
  List&lt;List&lt;SObject&gt;&gt; sList = [FIND 'TEST' IN ALL FIELDS
                                      RETURNING Case(Name), Contact(FirstName,LastName)];
}

public inherited sharing class MyClass {
  List&lt;Case&gt; lstCases = new List&lt;Case&gt;();
  for(Case c:[SELECT Id, Status FROM Case WHERE Status = 'In Progress']){
      c.Status = 'Closed';
      lstCasesToBeUpdated.add(c);
  }
  Update lstCasesToBeUpdated;
}
</pre>
<h2>Exceptions</h2>
<p>No issue will be raised for test classes, i.e. classes annotated with &lt;code&gt;@isTest&lt;/code&gt;</p>
<h2>See</h2>
<ul>
<li><a href="https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_classes_keywords_sharing.htm">Using the with sharing, without sharing, and inherited sharing Keywords</a></li>
</ul>
